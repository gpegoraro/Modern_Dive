---
title: "Chapter_6"
output: github_document
---

Code for the Chapter 6 of the [Modern Dive book](https://moderndive.com/6-regression.html#regression).

```{r load-packages}
library(tidyverse)
library(moderndive)
library(skimr)
library(ISLR)
library(ggthemes)
```

Set the palette and the running theme for ggplot2.

```{r set-theme-palette}
theme_set(theme_bw())
theme_update(axis.text.x = element_text(
angle = -45,
hjust = 0,
vjust = 0.5
))
```

## 6.1

```{r}
evals_ch6 <- evals %>%
  select(ID, score, age, gender)

glimpse(evals_ch6)
```

```{r}
evals_ch6 %>%
  summarise(across(c(age, score),
                   list(mean = mean, median = median)))
```
```{r}
evals_ch6 %>%
  skim()
```
```{r}
evals_ch6 %>%
  get_correlation(score ~ age)
```
```{r}
evals_ch6 %>%
  ggplot(aes(x = age, 
             y = score,
             color = gender)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_tableau(name = "Gender") +
  labs(x = "Age",
       y = "Teaching Score")
```
```{r}
score_model_interaction <- lm(score ~ age * gender, data = evals_ch6)

get_regression_table(score_model_interaction)
```

Document the information about the analysis session

```{r sessionInfo, include=TRUE, echo=TRUE, results='markup'}
sessionInfo()
```
